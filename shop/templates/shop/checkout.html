{% extends "shop/base.html" %}


{% block content %}


<div class="row">
    <div class="col-md-12">
        <ul class="list-group" id="item-list">
          <h3 class="text-center">Voici votre liste</h3>  
        </ul>
    </div>
</div>
<div class="row">
    <div class="col-md-12">

      <form method="POSt">
        {% csrf_token %}
        <input type="hidden" id="items" name="items">
        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="nom">Nom</label>
            <input type="nom" class="form-control" id="nom" name="nom" placeholder="Nfrank">
          </div>
          <div class="form-group col-md-6">
            <label for="email">Email</label>
            <input type="email" class="form-control" id="email" name="email" placeholder="nfrank@gmail.com">
          </div>
        </div>
        <div class="form-group">
          <label for="inputAddress">Address</label>
          <input type="text" class="form-control" id="address" name="address" placeholder="Chapelle Obili">
        </div>
        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="ville">Ville</label>
            <input type="text" class="form-control" id="ville" name="ville" placeholder="Yaounde">
          </div>
          <div class="form-group col-md-4">
            <label for="pays">Pays</label>
            <select id="pays" name="pays" class="form-control">
              <option selected>Cameroun</option>
              <option>Nigeria</option>
              <option>Senegal</option>
              <option>Vietnam</option>
              <option>Gabon</option>
              <option>Congo</option>
              <option>Tchad</option>
              <option>France</option>
              <option>Belgique</option>
            </select>
          </div>
          <div class="form-group col-md-2">
            <label for="inputZip">Zip</label>
            <input name="zipcode" id="zipcode" type="text" class="form-control" placeholder="892 Chapelle Obili">
          </div>
          <div class="form-group col-md-2">
            <label for="total">Totale</label>
            <input name="total" id="total" type="readonly" class="bg-dark form-control" placeholder="Somme Totale">
          </div>
        </div>
        
        <button type="submit" class="btn btn-primary">Commander</button>
      </form>

    </div>
</div>

{% endblock %}

{% block js %}
  <script type="text/javascript">
    if(localStorage.getItem('panier')==null){
      var panier = {};

    }else {
      panier = JSON.parse(localStorage.getItem('panier'));

    }
    var total = 0;
    var nombre = 0;
    for(item in panier){
      let nom = panier[item][1];
      let quantite = panier[item][0];
      let prix = panier[item][2];
      nombre += quantite;
      total += prix; 

      let itemString = `<li class="list-group-item d-flex justify-content-between align-items-center">
                          ${nom}
                          <span class="badge badge-primary badge-pill">QTE: ${quantite}</span>
                          <span class="badge badge-warning badge-pill">F CFA  ${prix}</span>
                          </li>`;
                        $('#item-list').append(itemString);
    }
    let itemNombre = `<li class="list-group-item d-flex justify-content-between align-items-center">
      <b class="bg-danger" >PRIX ET QUANTITE TOTAL:</b>
      <span class="badge badge-danger badge-pill">TQTE: ${nombre}</span>
      <span class="badge badge-danger badge-pill">$ ${total}</span>
      </li>`;
    $('#item-list').append(itemNombre);
    $('#total').val("$" + total);



    $("#items").val(JSON.stringify(panier)); 


  </script>



{%endblock%}